<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spell & Learn</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;overflow:hidden;font-family:Arial,sans-serif;background:#cfe9ff}
canvas{display:block;touch-action:none}

.topbar{
  position:fixed;top:0;left:0;right:0;height:70px;
  background:#ffffffee;display:flex;align-items:center;
  justify-content:space-between;padding:0 12px;z-index:10
}
.btn{
  background:#4caf50;color:#fff;border:none;
  border-radius:14px;padding:10px 14px;font-size:16px;
  margin:4px;
}
.btn-outline{
  background:#fff;color:#333;border:2px solid #4caf50;
}
.overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.45);
  display:flex;align-items:center;justify-content:center;z-index:20
}
.card{
  background:#fff;border-radius:24px;
  padding:24px;width:90%;max-width:380px;text-align:center
}
input{
  width:90%;
  padding:10px;
  font-size:18px;
  border-radius:10px;
  border:1px solid #ccc;
  margin:10px 0;
  text-align:center;
}
.hidden{display:none}
</style>
</head>

<body>

<!-- TOP BAR (GAME ONLY) -->
<div class="topbar hidden" id="gameTopbar">
  <div style="font-size:18px">â­ <span id="stars">0</span></div>
  <button class="btn" onclick="openResetConfirm()">ğŸ”„ Reset</button>
</div>

<canvas id="c" class="hidden"></canvas>

<!-- HOME SCREEN -->
<div class="overlay" id="home">
  <div class="card">
    <h2>Spell & Learn ğŸ±</h2>

    <div id="profileSection">
      <p id="greetText" style="font-size:18px"></p>
      <input id="nameInput" placeholder="Enter your name (optional)">
      <button class="btn" onclick="saveProfile()">Save Name</button>
    </div>

    <hr>

    <p style="font-size:18px">Choose how to play</p>

    <div>
      <button class="btn btn-outline" onclick="selectMode('Animals')">ğŸ¶ Animals</button>
      <button class="btn btn-outline" onclick="selectMode('Food')">ğŸ Food</button>
      <button class="btn btn-outline" onclick="selectMode('Vehicles')">ğŸš— Vehicles</button>
      <button class="btn btn-outline" onclick="selectMode('Nature')">ğŸŒ¿ Nature</button>
      <button class="btn btn-outline" onclick="selectMode('Home')">ğŸ  Home</button>
      <button class="btn btn-outline" onclick="selectMode('Random')">ğŸ² Random Mix</button>
    </div>

    <p id="modeText" style="margin-top:10px;font-size:16px"></p>

    <button class="btn" style="font-size:20px;margin-top:10px" onclick="startGame()">â–¶ï¸ Play</button>
  </div>
</div>

<!-- RESET CONFIRM -->
<div class="overlay hidden" id="resetPanel">
  <div class="card">
    <h3>Reset Progress</h3>
    <p>Type this word to confirm:</p>
    <div id="resetWord" style="font-size:28px;font-weight:bold"></div>
    <input id="resetInput">
    <button class="btn" onclick="closeReset()">Cancel</button>
    <button class="btn" id="confirmResetBtn" disabled>Confirm</button>
  </div>
</div>

<script>
/* ================= BASIC SETUP ================= */
const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");
function resize(){canvas.width=innerWidth;canvas.height=innerHeight}
resize();addEventListener("resize",resize);

/* ================= PROFILE & MODE ================= */
const STORE="spellLearnProfile";
let profile={
  name:"",
  stars:0,
  lastMode:"Animals"
};
let selectedMode="Animals";

/* ================= LOAD PROFILE ================= */
function loadProfile(){
  try{
    const d=JSON.parse(localStorage.getItem(STORE));
    if(d) profile=d;
  }catch{}
  document.getElementById("stars").textContent=profile.stars||0;
  selectedMode=profile.lastMode||"Animals";
  updateHomeUI();
}
loadProfile();

function saveProfile(){
  const name=document.getElementById("nameInput").value.trim();
  if(name) profile.name=name.substring(0,10);
  localStorage.setItem(STORE,JSON.stringify(profile));
  updateHomeUI();
}

function updateHomeUI(){
  const greet=document.getElementById("greetText");
  greet.textContent = profile.name ? `Hi, ${profile.name}! ğŸ‘‹` : "";
  document.getElementById("nameInput").value=profile.name||"";
  document.getElementById("modeText").textContent =
    "Selected: " + selectedMode;
}

function selectMode(mode){
  selectedMode=mode;
  profile.lastMode=mode;
  localStorage.setItem(STORE,JSON.stringify(profile));
  updateHomeUI();
}

/* ================= START GAME ================= */
function startGame(){
  document.getElementById("home").style.display="none";
  document.getElementById("gameTopbar").classList.remove("hidden");
  canvas.classList.remove("hidden");

  // PHASE 2 will use selectedMode here
  startGameplay();
}

/* ================= RESET ================= */
function openResetConfirm(){
  resetTargetWord="CAT";
  resetWord.textContent=resetTargetWord;
  resetInput.value="";
  confirmResetBtn.disabled=true;
  resetPanel.classList.remove("hidden");
}
function closeReset(){
  resetPanel.classList.add("hidden");
}
resetInput.oninput=()=>{
  confirmResetBtn.disabled = resetInput.value.toUpperCase() !== resetTargetWord;
};
confirmResetBtn.onclick=()=>{
  localStorage.clear();
  location.reload();
};

/* ================= GAMEPLACEHOLDER ================= */
/* Gameplay remains exactly as your stable version.
   Phase 2 will connect selectedMode to word lists. */

function startGameplay(){
  ctx.fillStyle="#000";
  ctx.font="28px Arial";
  ctx.fillText("Gameplay starts here (Phase 2)",50,150);
}
</script>

</body>
</html>
